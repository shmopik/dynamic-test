<html>
  <head>
    <script lang="javascript">
      parseCsvToArray = function(csv,delimiter = ","){
        const headers = csv.slice(0, csv.indexOf("\n")).split(delimiter);
        const rows = csv.slice(csv.indexOf("\n") + 1).split("\n");

        const arr = rows.map(function (row) {
          const values = row.split(delimiter);
          const el = headers.reduce(function (object, header, index) {
            object[header] = values[index];
            return object;
          }, {});
          return el;
        });

        return arr;
      }
      
      readSpiritsSection = function(spiritsArray, happy = false){
        console.log(JSON.stringify(spiritsArray));
      }
      
      const sections = [
        { id : "spirits", file : "test.csv", parser : readSpiritsSection }
      ];
      
      window.onload = function(){
        sections.forEach(section => {
          fetch(section.file)
            .then(response => response.text())
            .then(text => {
               const json = parseCsvToArray(text);
               section.parser(json);
            })
        })
      }
    </script>
  </head>
  <body>
    <div id="HE" class="lang-menu"></div>
    <div id="EN" class="lang-menu"></div>
  </body>
</html>
